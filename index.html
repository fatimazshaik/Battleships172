<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Group 3 -  Fatima Shaik and Sarbani Kumar (website template by Ryan Tsang)" />
  <title>EEC 172 Final Project - Battleships!</title>
  <!-- <link rel="stylesheet" type="text/css" href="assets/github-markdown-light.css" /> -->
  <link rel="stylesheet" href="assets/github-markdown-light.css" />
  <link rel="stylesheet" href="assets/style-customization.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<article class="markdown-body">
<header id="title-block-header">
<h1 class="title">EEC 172 Final Project - Battleships!</h1>
<!-- <p class="subtitle"><blockquote><b>EEC172 Final Project Webpage Example</b><br/> Note to current students: this is an <i>example</i> webpage and may not fulfill all stated requirements of the current quarter's assignment.<br/>The website source is hosted <a href="https://github.com/ucd-eec172/project-website-example">on github</a>. </blockquote></p> -->
<p class="author"><strong> Group 3 - Fatima Shaik and Sarbani Kumar</strong>
(website template by Ryan Tsang)</p>
<p class="date"><em>EEC172 SP24</em></p>
<div class="abstract">

<div class="abstract-title"><h2>Description</h2></div>
“Battleships!” is the application implemented for our EEC 172 final
project. This product is a recreation of the classic board game “Battleships”
on the CC3200 microcontroller. This game is a two player game where each 
player inputs their name on the micorntorller using a TV remote and then 
places their ships on a 6x6 board in a way that the other player can't see 
the opponents ship placement. Players will place small ships and medium sized ships. The medium ships will be rotatable. Afterwards, the players swaps boards 
and use the remote to try to attack the opponent's ship by selecting certain 
positions in the 6x6 board. When the player completed shooting the all the 
oppponents ships, the game is ober and the a message is sent over to AWS noting 
that that player won. For this project, the  game progress was displayed on an 
Adafruit OLED screen. Players could select ship positions using an AT&T Remote 
and a button on the board to rotate the ships. The game information was 
communicated via UART, and the winner information was sent to AWS.<br/><br/> Our source code can be
found <!-- replace this link -->
<a href="https://github.com/fatimazshaik/Battleships172SourceCode"> here
</a>.<br />

<div style="display:flex;flex-wrap:wrap;justify-content:space-evenly;padding-top:20px"> <div style="display: inline-block; vertical-align: bottom;"> <img src="./media/Image_001.jpg" style="width:auto;height:2in"/> <!-- <span class="caption"> </span> --> </div> <div style="display: inline-block; vertical-align: bottom;"> <img src="./media/Image_002.jpg" style="width:auto;height:2in" /> <!-- <span class="caption"> </span> --> </div> </div>
<h2>Video Demo</h2> 
<div style="text-align:center;margin:auto;max-width:560px"> <div style="padding-bottom:56.25%;position:relative;height:0;"> 
  <iframe width="560" height="315" src="https://www.youtube.com/embed/IHRAA0A09kU?si=vY-vJBgPztJsIqv2" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe></div></div> 
</div>
</header>
<nav id="TOC" role="doc-toc">
<h2 id="toc-title">Table of Contents</h2>
<ul>
<li><a href="#market-survey" id="toc-market-survey">Market
Survey</a></li>
<li><a href="#design" id="toc-design">Design</a>
<ul>
<li><a href="#system-architecture" id="toc-system-architecture">System
Architecture</a></li>
<li><a href="#functional-specification"
id="toc-functional-specification">Functional Specification</a></li>
</ul></li>
<li><a href="#implementation" id="toc-implementation">Implementation</a>
<li><a href="#challenges" id="toc-challenges">Challenges</a>
<li><a href="#future-work" id="toc-future-work">Future Work</a></li>
<li><a href="#finalized-bom" id="toc-finalized-bom">Finalized
BOM</a></li>
</ul>
</nav>
<!-- EDIT METADATA ABOVE FOR CONTENTS TO APPEAR ABOVE THE TABLE OF CONTENTS -->

<!-- ALL CONTENT THAT FOLLWOWS WILL APPEAR IN AND AFTER THE TABLE OF CONTENTS -->

<h1 id="market-survey">Market Survey</h1>
<p>There are various similar product on the market. The main two products
we would like to highlight is the original "Battleship" board game and 
the mobile game version of Battleships that is avaiable on GamePigeon.
In the "Battleship" board game, is from popular board game company Hasbro. Two players use tokens and physical board to store ship location. On the other 
physical board, player takes turns attacking certain position until one player
finishes attacking all the opponent's ships. The other product is from the 
mobile game pack, GamePigeon. To play this game, one would need an iPhone
making it more expensive. However, it is fully automated. Compared to these 
two products, our product has teh advantage of being cheap and automated, 
suited for individuals of all age groups.</p>
<div style="display:flex;flex-wrap:wrap;justify-content:space-evenly;">
  <div style='display: inline-block; vertical-align: top;'>
    <img src="./media/Image_003.jpg" style="width:auto;height:200"/>
    <span class="caption">
      <a href="https://shop.hasbro.com/en-us/product/battleship-classic-board-game-strategy-game-for-kids-ages-7-and-up-fun-kids-game-for-2-players/54D1C85E-CFBE-4625-9A9E-53C36F4D136C">Hasbro's Battleship Boardgame</a>
      <ul style="text-align:left;">
      <li>Inexpensive ($17)</li>
      <li>Not Automated</li>
      <li>Requires manually placing tokens and communication from 
        others to confirm a hit</li>
    </ul>
    </span>
  </div>
  <div style='display: inline-block; vertical-align: top;'>
    <img src="./media/Image_004.jpg" style="width:auto;height:200" />
    <span class="caption">
      <a href="https://apps.apple.com/us/app/gamepigeon/id1124197642">GamePigeon's Mobile Battleships Game</a>
      <ul style="text-align:left;">
      <li>Expensive (need an iPhone to play)</li>
      <li>Fully Automated</li>
      <li>Everything done on one device</li>
    </ul>
    </span>
  </div>
</div>

<h1 id="design">Design</h1>
<h2 id="system-architecture">System Architecture</h2>
<div style="display:flex;flex-wrap:wrap;justify-content:space-evenly;">
  <div style="display:inline-block;vertical-align:top;flex:1 0 400px;">
    <!-- As shown in the system's diagram a player will be  -->
    The ship's position is chosen using user input from the
    remote while the oritentation is picked using buttons on the    microcontroller. The position is decoded and checked to ensure
    no overlapping ships are placed. Concurrently, the board is
    being projected onto the OLED screen. At the end, the winner
    is sent to player's email by AWS. Figure 4 depicts the system
    architecture.
  </div>
  <div style="display:inline-block;vertical-align:top;flex:0 0 400px;">
    <div class="fig">
      <img src="./media/Image_005.jpg" style="width:90%;height:auto;" />
      <span class="caption">System Flowchart</span>
    </div>
  </div>
</div>

<h2 id="functional-specification">Functional Specification</h2>
<div style="display:flex;flex-wrap:wrap;justify-content:space-evenly;">
  <div style="display:inline-block;vertical-align:top;flex:1 0 300px;">
    The player is first presented with the start screen. They are
    asked to input their name. Next, they are presented with an
    empty board and some ships, where they can choose where to
    position their ships by using the remote and the buttons on the
    microcontroller. Next, the coordinates of their ship positions
    are stored in a 2D array and in a string (in order to be sent over
    UART). The player then passes the board off to another player,
    where they have the opportunity to attack the first player’s
    board until they find all the ships. 
  </div>
  <div style="display:inline-block;vertical-align:top;flex:0 0 500px">
    <div class="fig">
      <img src="./media/Image_006.jpg" style="width:90%;height:auto;" />
      <span class="caption">State Diagram</span>
    </div>
  </div>
</div>

<h1 id="implementation">Implementation</h1>
<h3 id="cc3200-launchxl-evaluation-board">CC3200-LAUNCHXL Evaluation
Board</h3>
<p>All game logic was controlled by a single CC3200 microcontroller. TI Cloud
Code Composer (ccs) was the IDE used to debug, build and upload C-code to the 
microntroller. The microntroller was in charge of decoding the IR signals
generated by the remote while recieveing and transmiting charcters over UART. 
Through parsing the IR signals, handling interrupts from the GPIO pins that are
associated to SW3 and the pin associated to the IR pin, the micontroller was 
able to recieve user input. Meanwhile the OLED and AWS worked togetehr to provide a visual cue to show what was going on in the game.</p>

<h3 id="aws-iot-core">AWS IoT Core</h3>
<div style="display:flex;flex-wrap:wrap;justify-content:space-between;">
  <div style='display: inline-block; vertical-align: top;flex:1 0 200px'>
    At the end of the game, when the endgame screen is reached,
    the player that won is sent to AWS using their Internet of
    Things device/shadow feature. Specifically, the SNS feature
    and the http_post() function was used. We created an SNS
    topic and a subscription with an EMAIL protocol. Next, we
    created a new rule that attached an action when the rule was
    triggered. Finally, we simply called the http post function with
    the player name and the result of the game.
  </div>
  <div style='display: inline-block; vertical-align: top;flex:0 0 400px'>
    <div class="fig">
      <img src="./media/Image_007.jpg" style="width:auto;height:2.5in" />
      <span class="caption">Device Shadow JSON</span>
    </div>
  </div>
</div>

<h3 id="oled-display">OLED Display</h3>
<div style="display:flex;flex-wrap:wrap;justify-content:space-between;">
  <div style='display: inline-block; vertical-align: top;flex:1 0 400px'>
    Everything was projected onto the OLED screen, including a start screen, 
    the player's board, an attack board, and an endgame screen. Depending on 
    the state of the game, the OLED will display a different screen. The OLED 
    provides a visual cue for the user to understand what is happening in the 
    game.
  </div>
  <div style='display: inline-block; vertical-align: top;flex:0 0 400px'>
    <div class="fig">
      <img src="./media/Image_008.jpg" style="width:auto;height:2in" />
      <span class="caption">OLED Wiring Diagram</span>
    </div>
  </div>
</div>

<h3 id="ir-receiver">IR Receiver</h3>
<div style="display:flex;flex-wrap:wrap;justify-content:space-between;">
  <div style='display: inline-block; vertical-align: top;flex:1 0 400px'>
    In order to receive signals from the AT&T remote, there were
    multiple steps that had to be taken in previous labs to set
    up a foundation. First, we built an application circuit for the
    IR receiver. By doing this, an effective low pass filter is
    built which can eliminate unnecessary noise. The output of the 
    circuit is connected to a GPIO pin. The GPIO pin was ableto capture
    the signals from pressing a button on a remote. Using an a interrupt 
    handler associated to that pin, we set a flag high. Once when the flag is set to high, portions of our code is ran, like changing the position of 
    ship or typing a user's name.  
  </div>
  <div style='display: inline-block; vertical-align: top;flex:0 0 400px'>
    <div class="fig">
      <img src="./media/Image_009.jpg" style="width:auto;height:2in" />
      <span class="caption">GPIO Button Wiring Diagram</span>
    </div>
  </div>
</div>


<h3 id="gpio-button">GPIO Button</h3>
<div style="display:flex;flex-wrap:wrap;justify-content:space-between;">
  <div style='display: inline-block; vertical-align: top;flex:1 0 400px'>
    In order to use the GPIO button to rotate the position of the
    ship, we chose to use SW3. We created an interrupt function.
    Then, when the flag for the button being pushed went high,
    the flag is checked in the main function and the ship is rotated
    accordingly.</div>
  <div style='display: inline-block; vertical-align: top;flex:0 0 400px'>
    <div class="fig">
      <img src="./media/Image_010.jpg" style="width:auto;height:2in" />
      <span class="caption">IR Receiver Wiring Diagram</span>
    </div>
  </div>
</div>

<h1 id="challenges">Challenges</h1>

<p>The most two significant challenges faced during the project development
  was (1) UART Buffer Size and (2) Board-to-Board Communication. These two
  problems are related to using UART with the microcontrollers.</p>

<h2 id="uart-buffer-size">UART Buffer Size</h2>
<p>The first problem we encountered was the size of the buffer of UARTA1. The core of our game logic relied on using a 2D array to digitally represent the state of the game. The rationale behind this design choice was that when a user attacks a position on the board, a 2D array provides an easy and fast way to check if the attack is a successful hit or not (taking O(1) time). This feature worked seamlessly with the rest of our logic, but since we couldn't send a 2D array over UART, our TA instructed us to use an algorithm to convert the 2D array into a string. Despite doing this, UART couldn't transmit every element in the string. Out of the 36 elements in the string, UART was only successfully sending 15 elements. After troubleshooting this problem, we discovered that UARTA1 had a buffer size of 15 characters. Thus, we decided that instead of sending the entire array, we would send the coordinates or single characters when necessary.</p>

<h2 id="board-to-board-communication">Board-to-Board Communication</h2>
<p>The main issue encountered was implementing board to board communication to
 enforce a turn-based system for the game. The initial plan was to implement
 this feature by using UART to connect the transmitter pin of the first
 microcontroller to the receiver pin of the second microcontroller, and vice
 versa. However, when doing this, we faced significant noise and random
 characters transmitted over the lines, which disrupted communication and 
 resulted in incorrect messages being sent over. Unfortunately, this issue
 wasn't identified until later in this project, when tested the code with two
 microcontrollers. Since this testing wasn't done until later in the timeline
 we weren't able to resolve this issue in time for checkoff. As a workaround,
 we modified the project so that messages were sent to a single
 microcontroller, requiring players to exchange microcontrollers after placing
 their ship positions.</p>

<h1 id="future-work">Future Work</h1>
<p>If there had been more time, we would have implemented these three additional
  features: (1) completing the two-board communication, (2)
  incorporating audio cues, and (3) enabling user input via an analog stick.
  Completing the two-board communication feature would enforce a turn-based
  system, ensuring players follow the rules. The second feature, audio cues
  would involve connecting a piezo or a buzzer that would play a sound when a
  ship has been attacked, a feature from the original game. Lastly, using an
  analog stick would enhance and simplify user movement.</p>
<h1 id="finalized-bom">Finalized BOM</h1>
<!-- you can convert google sheet cells to html for free using a converter
  like https://tabletomarkdown.com/convert-spreadsheet-to-html/ -->

<table style="border-collapse:collapse;">
<thead>
  <tr>
    <th><p>No.</p></th>
    <th><p>PART NAME</p></th>
    <th><p>DESCRIPTION</p></th>
    <th><p>Qty</p></th>
    <th><p>SUPPLIER / MANUFACTURER</p></th>
    <th><p>UNIT COST</p></th>
    <th><p>TOTAL PART COST</p></th>
    <th><p>Purpose</p></th>
  </tr>
</thead>
<tbody>
  <tr>
    <td><p>1</p></td>
    <td><p>CC3200-LAUNCHXL</p></td>
    <td><p>MCU Evaluation Board</p></td>
    <td><p>2</p></td>
    <td><p>Provided by EEC172 Course</p></td>
    <td><p>$66.00</p></td>
    <td><p>$132.00</p></td>
    <td><p>Controlled remote and executed game logic </p></td>
  </tr>
  <tr>
    <td><p>2</p></td>
    <td><p>Adafruit 1431 OLED</p></td>
    <td><p>128x128 RGB OLED Display. SPI protocol</p></td>
    <td><p>2</p></td>
    <td><p>Provided by EEC172 Course</p></td>
    <td><p>$39.95</p></td>
    <td><p>$79.90</p></td>
    <td><p>Display game screen</p></td>
  </tr>
  <tr>
    <td><p>3</p></td>
    <td><p>Vishay TSOP31130 IR RCVR</p></td>
    <td><p>30kHz carrier frequency</p></td>
    <td><p>2</p></td>
    <td><p>Provided by EEC172 Course</p></td>
    <td><p>$1.41</p></td>
    <td><p>$2.82</p></td>
    <td><p>Decode user inputs</p></td>
  </tr>
  <tr>
    <td><p>4</p></td>
    <td><p>330 ohm resistor</p></td>
    <td><p>330 ohm resistor, &lt;5% tolerance, 3W</p></td>
    <td><p>2</p></td>
    <td><p>Provided by EEC172 Course</p></td>
    <td><p>$0.59</p></td>
    <td><p>$1.18</p></td>
    <td><p>Current limit for IR receiver</p></td>
  </tr>
  <tr>
    <td><p>5</p></td>
    <td><p>ATT-RC1534801 Remote</p></td>
    <td><p>General-purpose TV remote. IR NTC protocol</p></td>
    <td><p>2</p></td>
    <td><p>Provided by EEC172 Course</p></td>
    <td><p>$9.99</p></td>
    <td><p>$19.98</p></td>
    <td><p> Enabled user input </p></td>
  </tr>
  <tr>
    <td><p>6</p></td>
    <td><p>10uF Capacitor</p></td>
    <td><p>Electrolytic Cap 100V</p></td>
    <td><p>2</p></td>
    <td><p>Provided by EEC172 Course</p></td>
    <td><p>$0.18</p></td>
    <td><p>$0.36</p></td>
    <td><p>DC filtering for IR receiver</p></td>
  </tr>
  <tr>
    <td colspan="3">
      <p>TOTAL PARTS</p></td>
    <td><p>12</p></td>
    <td colspan="2">
      <p>TOTAL</p></td>
    <td><p>$235.34</p></td>
    <td></td>
  </tr>
  <tr>
    <td colspan="3">
      <p>TOTAL PARTS (Excluding Provided)</p></td>
    <td><p>0</p></td>
    <td colspan="2">
      <p>TOTAL (Exluding Provided)</p></td>
    <td><p>$0</p></td>
    <td></td>
  </tr>
</tbody>
</table>
</article>
</html>